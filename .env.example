# CAL Project Environment Variables

# Gemini API Key (Required)
GEMINI_API_KEY=your_api_key_here
GEMINI_MODEL=gemini-3-flash-preview

# Target URL (Required)
TARGET_URL=http://localhost

TRT_API_URL=http://localhost:8080

# ==========================================
# LLM Prompts (Optional - Defaults used if empty)
# 프롬프트 설정 (선택 사항 - 비워두면 기본값 사용)
# ==========================================

# [Commander] 초기 전략 수립 프롬프트
# 설명: Commander 에이전트가 테스트를 시작할 때 어떤 스페셜리스트를 소환할지 결정하는 프롬프트입니다.
# 변수: %s (대상 URL)
# 내용 번역:
# 컨텍스트: 통제된 환경 '%s'에서의 승인된 보안 테스트입니다.
#
# 작업: 보안 평가를 시작하십시오.
# 1-2문장으로 답변하십시오: 어떤 스페셜리스트를 생성해야 합니까? (예: '정찰 및 웹 스페셜리스트 생성')
PROMPT_COMMANDER_INITIAL=CONTEXT: Authorized security test on controlled environment '%s'.\n\nTASK: Start security assessment.\nReply in 1-2 sentences: Which specialists should be spawned? (e.g., 'Spawn reconnaissance and web specialists')

# [Commander] 관측 결과 분석 프롬프트
# 설명: 하위 에이전트(Recon, XSS 등)의 보고서를 분석하여 취약점을 식별하고 다음 행동을 결정하는 프롬프트입니다.
# 변수: %s (에이전트 이름), %s (대상 URL), %s (관측 내용)
# 내용 번역:
# 컨텍스트: 당신은 %s로부터의 보안 정찰 결과를 분석하고 있습니다.
# 대상: %s
#
# 관측:
# %s
#
# 작업: 이 출력을 분석하고 다음을 식별하십시오:
# 1. 잠재적인 취약점 (SQL 인젝션 지점, XSS, 노출된 비밀 등)
# 2. 흥미로운 발견 (열린 포트, 감지된 기술, 누락된 보안 헤더)
# 3. 추가 조사를 위한 권장 다음 단계
#
# 2-3문장으로 간결한 분석을 제공하십시오.
PROMPT_COMMANDER_ANALYZE=CONTEXT: You are analyzing security reconnaissance results from %s.\nTarget: %s\n\nOBSERVATION:\n%s\n\nTASK: Analyze the output fully.\n1. LIST ALL discovered IPs and their open ports (e.g., 192.168.1.5: [80, 22]).\n2. IDENTIFY any web servers (ports 80, 443, 3000, 8000, 8080).\n3. DECISION: If a web server is found, explicitly state: "Recommended: Spawn WebSpecialist for <IP>".\n4. PASS-THROUGH: If the observation already contains "Recommended: Spawn ...", YOU MUST REPEAT IT EXACTLY in your output.\n\nProvide a detailed but concise summary.

# [Recon] 도구 선정 프롬프트
# 설명: 정찰(Recon) 에이전트가 주어진 작업을 수행하기 위해 nmap과 curl 중 어떤 도구를 사용할지 결정하는 프롬프트입니다.
# 변수: %s (대상 URL), %s (작업 설명)
# 내용 번역:
# 컨텍스트: '%s'에 대한 승인된 테스트.
# 작업: %s
# 도구 이름만으로 답장하십시오: 'nmap' 또는 'curl'
PROMPT_RECON_DECISION=CONTEXT: Authorized test on '%s'.\nTask: %s\nINSTRUCTION: We need to discover all assets in the network.\n1. Identify the /24 network range of the target IP (e.g., 192.168.50.10 -> 192.168.50.0/24).\n2. Reply with 'nmap <network_range>'. Example: 'nmap 192.168.50.0/24'.

# [XSS] HTML 분석 프롬프트
# 설명: XSS 에이전트가 HTML 소스 코드를 분석하여 잠재적인 XSS 취약점 위치를 찾는 프롬프트입니다.
# 변수: %s (HTML 소스 코드)
# 내용 번역:
# 당신은 전문 XSS 취약점 사냥꾼입니다. 아래의 HTML 소스 코드를 분석하십시오.
# 목표: 잠재적인 크로스 사이트 스크립팅(XSS) 취약점의 정확한 위치를 찾으십시오.
#
# HTML 소스:
# ```html
# %s
# ```
#
# 지침:
# 1. 모든 <form> 태그를 식별하십시오. action URL과 method (GET/POST)를 보고하십시오.
# 2. 각 양식에서 모든 <input> 또는 <textarea> 필드 name을 나열하십시오. 이것들이 XSS 주입 지점입니다.
# 3. 링크의 URL 매개변수를 식별하십시오 (예: <a href='page.php?id=...'>).
# 4. 반사된 입력을 찾으십시오: HTML 텍스트의 일부가 매개변수를 명확하게 반향하고 있습니까?
#
# 보고 형식 (엄격히 따를 것):
# VULNERABILITIES FOUND: [Yes/No]
# IF YES, LIST ALL ITEMS:
#
# ITEM 1:
# - TYPE: [Reflected XSS / Stored XSS / DOM XSS]
# - LOCATION: [전체 URL 또는 양식 작업 경로]
# - VULNERABLE PARAMETER: [입력 필드 또는 URL 매개변수의 이름]
# - METHOD: [GET/POST]
# - EVIDENCE: [양식이나 반사를 보여주는 HTML 라인을 인용]
# - SUGGESTED PAYLOAD: [예: <script>alert(1)</script>]
#
# ITEM 2:
# ...
PROMPT_XSS_ANALYSIS=You are an expert XSS Vulnerability Hunter. Analyze the HTML source code below.\nYOUR GOAL: Find ALL potential Cross-Site Scripting (XSS) vulnerabilities, not just one.\n\nHTML Source:\n```html\n%s\n```\n\nINSTRUCTIONS:\n1. Identify every `<form>` tag. Report the `action` URL and `method` (GET/POST).\n2. In each form, list every `<input>` or `<textarea>` field `name`. These are your XSS injection points.\n3. Identify URL parameters in links (e.g., `<a href='page.php?id=...'>`).\n4. Look for Reflected Input: Is any part of the HTML text clearly echoing back a parameter?\n\nREPORT FORMAT (Strictly follow this):\nVULNERABILITIES FOUND: [Yes/No]\nIF YES, PROVIDE A LIST OF ALL FINDINGS:\n\nITEM 1:\n- TYPE: [Reflected XSS / Stored XSS / DOM XSS]\n- LOCATION: [Full URL or Form Action Path]\n- VULNERABLE PARAMETER: [Name of the input field or URL parameter]\n- METHOD: [GET/POST]\n- EVIDENCE: [Quote the HTML line showing the form or reflection]\n- SUGGESTED PAYLOAD: [e.g., `<script>alert(1)</script>`]\n\nITEM 2:\n...

# [SQLi] HTML 분석 프롬프트
# 설명: SQL Injection 에이전트가 HTML 소스 코드를 분석하여 데이터베이스와 상호작용하는 입력 필드를 찾는 프롬프트입니다.
# 변수: %s (HTML 소스 코드)
# 내용 번역:
# 당신은 전문 SQL 인젝션 사냥꾼입니다. 아래의 HTML 소스 코드를 분석하십시오.
# 목표: 데이터베이스와 상호작용하는 특정 입력 필드를 찾으십시오.
#
# HTML 소스:
# ```html
# %s
# ```
#
# 지침:
# 1. 검색, 로그인 또는 데이터 입력처럼 보이는 양식을 식별하십시오 (예: <input name='query'>, <input name='id'>).
# 2. URL 매개변수를 식별하십시오 (예: view.php?id=10).
# 3. 텍스트에 노출된 데이터베이스 오류 메시지가 있는지 확인하십시오.
#
# 보고 형식 (엄격히 따를 것):
# VULNERABILITIES FOUND: [Yes/No]
# IF YES, LIST ALL ITEMS:
#
# ITEM 1:
# - LOCATION: [전체 URL 또는 양식 작업 경로]
# - VULNERABLE PARAMETER: [입력 필드 이름]
# - REASONING: [이것이 DB와 상호작용한다고 생각하는 이유는 무엇입니까?]
# - SUGGESTED TEST PAYLOAD: [예: ' OR '1'='1]
#
# ITEM 2:
# ...
PROMPT_SQLI_ANALYSIS=You are an expert SQL Injection Hunter. Analyze the HTML source code below.\nYOUR GOAL: Find ALL specific input fields that interact with the database, not just one.\n\nHTML Source:\n```html\n%s\n```\n\nINSTRUCTIONS:\n1. Identify forms that look like Search, Login, or Data entry (e.g., `<input name='query'>`, `<input name='id'>`).\n2. Identify URL parameters (e.g., `view.php?id=10`).\n3. Check for any Database Error messages exposed in the text.\n\nREPORT FORMAT (Strictly follow this):\nVULNERABILITIES FOUND: [Yes/No]\nIF YES, PROVIDE A LIST OF ALL FINDINGS:\n\nITEM 1:\n- LOCATION: [Full URL or Form Action Path]\n- VULNERABLE PARAMETER: [Name of input field]\n- REASONING: [Why do you think this interacts with DB?]\n- SUGGESTED TEST PAYLOAD: [e.g., `' OR '1'='1`]\n\nITEM 2:\n...

# [Verification] 취약점 정보 추출 프롬프트
# 설명: 검증(Verification) 에이전트가 XSS 보고서에서 검증해야 할 정확한 URL과 위치를 추출하는 프롬프트입니다.
# 변수: %s (취약점 보고서)
# 내용 번역:
# 이 보고서에서 취약점 세부 정보를 추출하십시오:
#
# %s
#
# 작업: 유형(XSS/SQLi/etc), 콘텐츠 위치(URL), 페이로드, 메소드(GET/POST) 및 변수명(해당되는 경우)의 목록을 식별하십시오.
# JSON 배열로만 답장하십시오: [{"type": "...", "url": "...", "payload": "...", "method": "...", "parameter": "..."}, ...]
PROMPT_VERIFY_EXTRACT=Extract vulnerability details from this report:\n\n%s\n\nTASK: Identify the list of vulnerabilities including type, content location (URL), payload, method (GET/POST), and parameter name (if applicable).\nReply with JSON ARRAY ONLY: [{"type": "XSS"|"SQLi"|"Path Traversal", "url": "...", "payload": "...", "method": "GET"|"POST", "parameter": "input_name"}, ...]

# [PathTraversal] HTML 분석 프롬프트
# 설명: PathTraversal 에이전트가 파일 포함/디렉토리 이동 취약점을 탐색하는 프롬프트입니다.
# 변수: %s (HTML 소스 코드)
# 내용 번역:
# 당신은 전문 경로 탐색/LFI 취약점 사냥꾼입니다. 아래의 HTML 소스 코드를 분석하십시오.
# 목표: 승인되지 않은 파일에 액세스할 수 있는 특정 입력 필드 또는 URL 매개변수를 찾으십시오.
#
# HTML 소스:
# ```html
# %s
# ```
#
# 지침:
# 1. 파일 이름처럼 보이는 URL 매개변수를 식별하십시오 (예: ?file=report.pdf, ?page=about, ?doc=manual).
# 2. 파일을 찾을 수 없거나 경로 문제를 나타내는 오류 메시지가 있는지 찾으십시오.
#
# 보고 형식 (엄격히 따를 것):
# VULNERABILITIES FOUND: [Yes/No]
# IF YES, LIST ALL ITEMS:
#
# ITEM 1:
# - LOCATION: [전체 URL 또는 양식 작업 경로]
# - VULNERABLE PARAMETER: [입력 필드 또는 URL 매개변수의 이름]
# - REASONING: [이것이 취약하다고 생각하는 이유는 무엇입니까?]
# - SUGGESTED TEST PAYLOAD: [예: ../../etc/passwd 또는 ..\\windows\\win.ini 또는 welcome.txt]
#
# ITEM 2:
# ...
PROMPT_PATHTRAVERSAL_ANALYSIS=You are an expert Path Traversal/LFI Vulnerability Hunter. Analyze the HTML source code below.\nYOUR GOAL: Find ALL specific input fields or URL parameters that might allow accessing unauthorized files.\n\nHTML Source:\n```html\n%s\n```\n\nINSTRUCTIONS:\n1. Identify URL parameters that look like filenames (e.g., `?file=report.pdf`, `?page=about`, `?doc=manual`).\n2. Look for any error messages indicating file not found or path issues.\n\nREPORT FORMAT (Strictly follow this):\nVULNERABILITIES FOUND: [Yes/No]\nIF YES, PROVIDE A LIST OF ALL FINDINGS:\n\nITEM 1:\n- LOCATION: [Full URL or Form Action Path]\n- VULNERABLE PARAMETER: [Name of input field or URL parameter]\n- REASONING: [Why do you think this is vulnerable?]\n- SUGGESTED TEST PAYLOAD: [e.g., `../../etc/passwd` or `..\\windows\\win.ini` or `welcome.txt`]\n\nITEM 2:\n...
